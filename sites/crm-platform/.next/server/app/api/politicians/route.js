"use strict";(()=>{var e={};e.id=7689,e.ids=[7689],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39446:(e,t,i)=>{i.r(t),i.d(t,{originalPathname:()=>N,patchFetch:()=>y,requestAsyncStorage:()=>h,routeModule:()=>m,serverHooks:()=>x,staticGenerationAsyncStorage:()=>g});var a={};i.r(a),i.d(a,{DELETE:()=>d,GET:()=>c,POST:()=>l,PUT:()=>u});var r=i(49303),n=i(88716),o=i(60670),s=i(87070),p=i(72331);async function c(e){try{let t=e.nextUrl.searchParams,i=parseInt(t.get("page")||"1"),a=parseInt(t.get("limit")||"10"),r=t.get("search")||"",n=t.get("sortBy")||"politicianName",o=t.get("sortOrder")||"asc",c=(i-1)*a,l=r?{OR:[{politicianName:{contains:r,mode:"insensitive"}},{party:{contains:r,mode:"insensitive"}},{position:{contains:r,mode:"insensitive"}},{state:{contains:r,mode:"insensitive"}}]}:{},u=await p._.politician.count({where:l}),d=(await p._.politician.findMany({where:l,skip:c,take:a,orderBy:{[n]:o},select:{id:!0,politicianName:!0,party:!0,position:!0,state:!0,createdAt:!0,updatedAt:!0}})).map(e=>({...e,name:e.politicianName}));return s.NextResponse.json({data:d,pagination:{total:u,page:i,limit:a,totalPages:Math.ceil(u/a)}})}catch(e){return console.error("Error fetching politicians:",e),s.NextResponse.json({error:"Failed to fetch politicians"},{status:500})}}async function l(e){try{let{name:t,...i}=await e.json(),a=await p._.politician.create({data:{politicianName:t,...i}});return s.NextResponse.json({...a,name:a.politicianName},{status:201})}catch(e){return console.error("Error creating politician:",e),s.NextResponse.json({error:"Failed to create politician"},{status:500})}}async function u(e){try{let{id:t,name:i,...a}=await e.json(),r=await p._.politician.update({where:{id:t},data:{politicianName:i,...a}});return s.NextResponse.json({...r,name:r.politicianName})}catch(e){return console.error("Error updating politician:",e),s.NextResponse.json({error:"Failed to update politician"},{status:500})}}async function d(e){try{let t=e.nextUrl.searchParams.get("id");if(!t)return s.NextResponse.json({error:"ID is required"},{status:400});return await p._.politician.delete({where:{id:t}}),s.NextResponse.json({success:!0})}catch(e){return console.error("Error deleting politician:",e),s.NextResponse.json({error:"Failed to delete politician"},{status:500})}}let m=new r.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/politicians/route",pathname:"/api/politicians",filename:"route",bundlePath:"app/api/politicians/route"},resolvedPagePath:"/home/bish/Downloads/sites/crm-platform/app/api/politicians/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:h,staticGenerationAsyncStorage:g,serverHooks:x}=m,N="/api/politicians/route";function y(){return(0,o.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:g})}},72331:(e,t,i)=>{i.d(t,{_:()=>n});var a=i(53524);let r=globalThis;r.prisma||(r.prisma=new a.PrismaClient({log:["error"]}));let n=r.prisma}};var t=require("../../../webpack-runtime.js");t.C(e);var i=e=>t(t.s=e),a=t.X(0,[9380,5972],()=>i(39446));module.exports=a})();