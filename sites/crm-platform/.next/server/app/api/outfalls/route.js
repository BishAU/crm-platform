(()=>{var e={};e.id=8488,e.ids=[8488],e.modules={96330:e=>{"use strict";e.exports=require("@prisma/client")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},93596:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>h,routeModule:()=>f,serverHooks:()=>g,workAsyncStorage:()=>y,workUnitAsyncStorage:()=>m});var a={};r.r(a),r.d(a,{DELETE:()=>p,GET:()=>l,POST:()=>c,PUT:()=>d});var n=r(42706),o=r(28203),s=r(45994),i=r(39187),u=r(33019);async function l(e){try{let{searchParams:t}=new URL(e.url),r=parseInt(t.get("page")||"1"),a=parseInt(t.get("limit")||"10"),n=t.get("search")||"",o=t.get("sortBy")||"outfallName",s=t.get("sortOrder")||"asc",l=(r-1)*a,c=n?{OR:[{outfallName:{contains:n,mode:"insensitive"}},{authority:{contains:n,mode:"insensitive"}},{type:{contains:n,mode:"insensitive"}},{state:{contains:n,mode:"insensitive"}}]}:{},d=await u.z.outfall.count({where:c}),p=(await u.z.outfall.findMany({where:c,skip:l,take:a,orderBy:{[({outfallName:"outfallName",authority:"authority",type:"type",state:"state",createdAt:"createdAt"})[o]||"outfallName"]:s},select:{id:!0,outfallName:!0,authority:!0,contact:!0,contact_email:!0,contact_name:!0,indigenousNation:!0,landCouncil:!0,latitude:!0,longitude:!0,state:!0,type:!0,createdAt:!0,updatedAt:!0}})).map(e=>({...e,name:e.outfallName}));return i.NextResponse.json({data:p,pagination:{total:d,page:r,limit:a,totalPages:Math.ceil(d/a)}})}catch(e){return console.error("Error fetching outfalls:",e),i.NextResponse.json({error:"Failed to fetch outfalls"},{status:500})}}async function c(e){try{let{name:t,...r}=await e.json(),a=await u.z.outfall.create({data:{outfallName:t,...r}});return i.NextResponse.json({...a,name:a.outfallName},{status:201})}catch(e){return console.error("Error creating outfall:",e),i.NextResponse.json({error:"Failed to create outfall"},{status:500})}}async function d(e){try{let{id:t,name:r,...a}=await e.json(),n=await u.z.outfall.update({where:{id:t},data:{outfallName:r,...a}});return i.NextResponse.json({...n,name:n.outfallName})}catch(e){return console.error("Error updating outfall:",e),i.NextResponse.json({error:"Failed to update outfall"},{status:500})}}async function p(e){try{let{searchParams:t}=new URL(e.url),r=t.get("id");if(!r)return i.NextResponse.json({error:"ID is required"},{status:400});return await u.z.outfall.delete({where:{id:r}}),i.NextResponse.json({success:!0})}catch(e){return console.error("Error deleting outfall:",e),i.NextResponse.json({error:"Failed to delete outfall"},{status:500})}}let f=new n.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/outfalls/route",pathname:"/api/outfalls",filename:"route",bundlePath:"app/api/outfalls/route"},resolvedPagePath:"/home/bish/Downloads/sites/crm-platform/app/api/outfalls/route.ts",nextConfigOutput:"",userland:a}),{workAsyncStorage:y,workUnitAsyncStorage:m,serverHooks:g}=f;function h(){return(0,s.patchFetch)({workAsyncStorage:y,workUnitAsyncStorage:m})}},96487:()=>{},78335:()=>{},33019:(e,t,r)=>{"use strict";r.d(t,{z:()=>n});var a=r(96330);let n=globalThis.prisma??new a.PrismaClient},24982:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{describeHasCheckingStringProperty:function(){return i},describeStringPropertyAccess:function(){return s},isRequestAPICallableInsideAfter:function(){return c},throwWithStaticGenerationBailoutError:function(){return u},throwWithStaticGenerationBailoutErrorWithDynamicError:function(){return l},wellKnownProperties:function(){return d}});let a=r(82312),n=r(3295),o=/^[A-Za-z_$][A-Za-z0-9_$]*$/;function s(e,t){return o.test(t)?`\`${e}.${t}\``:`\`${e}[${JSON.stringify(t)}]\``}function i(e,t){let r=JSON.stringify(t);return`\`Reflect.has(${e}, ${r})\`, \`${r} in ${e}\`, or similar`}function u(e,t){throw new a.StaticGenBailoutError(`Route ${e} couldn't be rendered statically because it used ${t}. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`)}function l(e,t){throw new a.StaticGenBailoutError(`Route ${e} with \`dynamic = "error"\` couldn't be rendered statically because it used ${t}. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`)}function c(){let e=n.afterTaskAsyncStorage.getStore();return(null==e?void 0:e.rootTaskSpawnPhase)==="action"}let d=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toString","valueOf","toLocaleString","then","catch","finally","status","displayName","toJSON","$$typeof","__esModule"])},20614:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ReflectAdapter",{enumerable:!0,get:function(){return r}});class r{static get(e,t,r){let a=Reflect.get(e,t,r);return"function"==typeof a?a.bind(e):a}static set(e,t,r,a){return Reflect.set(e,t,r,a)}static has(e,t){return Reflect.has(e,t)}static deleteProperty(e,t){return Reflect.deleteProperty(e,t)}}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[5994,5452],()=>r(93596));module.exports=a})();