(()=>{var t={};t.id=3947,t.ids=[3947],t.modules={96330:t=>{"use strict";t.exports=require("@prisma/client")},10846:t=>{"use strict";t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:t=>{"use strict";t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:t=>{"use strict";t.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:t=>{"use strict";t.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:t=>{"use strict";t.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},11584:(t,e,r)=>{"use strict";r.r(e),r.d(e,{patchFetch:()=>f,routeModule:()=>d,serverHooks:()=>y,workAsyncStorage:()=>p,workUnitAsyncStorage:()=>h});var a={};r.r(a),r.d(a,{GET:()=>u,POST:()=>l});var n=r(42706),o=r(28203),i=r(45994),s=r(39187),c=r(33019);async function u(t){try{let{searchParams:e}=new URL(t.url),r=parseInt(e.get("page")||"1"),a=parseInt(e.get("limit")||"10"),n=e.get("search")||"";e.get("sortBy");let o=e.get("sortOrder")||"asc",i=(r-1)*a,u=n?{OR:[{authority:{contains:n,mode:"insensitive"}},{state:{contains:n,mode:"insensitive"}}]}:{},l=(await c.z.outfall.groupBy({by:["authority"],where:{...u,authority:{not:null}}})).length,d=await c.z.outfall.groupBy({by:["authority","id","contact","contact_email","contact_name","state","createdAt","updatedAt"],where:{...u,authority:{not:null}},skip:i,take:a,orderBy:{authority:o}});return s.NextResponse.json({data:d.map(t=>({id:t.id,authority:t.authority,contact:t.contact,contact_email:t.contact_email,contact_name:t.contact_name,state:t.state,createdAt:t.createdAt,updatedAt:t.updatedAt})),pagination:{total:l,page:r,limit:a,totalPages:Math.ceil(l/a)}})}catch(t){return console.error("Error fetching water authorities:",t),s.NextResponse.json({error:"Failed to fetch water authorities"},{status:500})}}async function l(t){try{let e=await t.json(),r=await c.z.outfall.create({data:{authority:e.authority,contact:e.contact,contact_email:e.contact_email,contact_name:e.contact_name,state:e.state},select:{id:!0,authority:!0,contact:!0,contact_email:!0,contact_name:!0,state:!0,createdAt:!0,updatedAt:!0}});return s.NextResponse.json(r,{status:201})}catch(t){return console.error("Error creating water authority:",t),s.NextResponse.json({error:"Failed to create water authority"},{status:500})}}let d=new n.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/water-authorities/route",pathname:"/api/water-authorities",filename:"route",bundlePath:"app/api/water-authorities/route"},resolvedPagePath:"/home/bish/Downloads/sites/crm-platform/app/api/water-authorities/route.ts",nextConfigOutput:"",userland:a}),{workAsyncStorage:p,workUnitAsyncStorage:h,serverHooks:y}=d;function f(){return(0,i.patchFetch)({workAsyncStorage:p,workUnitAsyncStorage:h})}},96487:()=>{},78335:()=>{},33019:(t,e,r)=>{"use strict";r.d(e,{z:()=>n});var a=r(96330);let n=globalThis.prisma??new a.PrismaClient},24982:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t,e){for(var r in e)Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}(e,{describeHasCheckingStringProperty:function(){return s},describeStringPropertyAccess:function(){return i},isRequestAPICallableInsideAfter:function(){return l},throwWithStaticGenerationBailoutError:function(){return c},throwWithStaticGenerationBailoutErrorWithDynamicError:function(){return u},wellKnownProperties:function(){return d}});let a=r(82312),n=r(3295),o=/^[A-Za-z_$][A-Za-z0-9_$]*$/;function i(t,e){return o.test(e)?`\`${t}.${e}\``:`\`${t}[${JSON.stringify(e)}]\``}function s(t,e){let r=JSON.stringify(e);return`\`Reflect.has(${t}, ${r})\`, \`${r} in ${t}\`, or similar`}function c(t,e){throw new a.StaticGenBailoutError(`Route ${t} couldn't be rendered statically because it used ${e}. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`)}function u(t,e){throw new a.StaticGenBailoutError(`Route ${t} with \`dynamic = "error"\` couldn't be rendered statically because it used ${e}. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`)}function l(){let t=n.afterTaskAsyncStorage.getStore();return(null==t?void 0:t.rootTaskSpawnPhase)==="action"}let d=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toString","valueOf","toLocaleString","then","catch","finally","status","displayName","toJSON","$$typeof","__esModule"])},20614:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"ReflectAdapter",{enumerable:!0,get:function(){return r}});class r{static get(t,e,r){let a=Reflect.get(t,e,r);return"function"==typeof a?a.bind(t):a}static set(t,e,r,a){return Reflect.set(t,e,r,a)}static has(t,e){return Reflect.has(t,e)}static deleteProperty(t,e){return Reflect.deleteProperty(t,e)}}}};var e=require("../../../webpack-runtime.js");e.C(t);var r=t=>e(e.s=t),a=e.X(0,[5994,5452],()=>r(11584));module.exports=a})();