"use strict";(()=>{var t={};t.id=3439,t.ids=[3439],t.modules={53524:t=>{t.exports=require("@prisma/client")},20399:t=>{t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:t=>{t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},21191:(t,e,a)=>{a.r(e),a.d(e,{originalPathname:()=>y,patchFetch:()=>g,requestAsyncStorage:()=>d,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h});var r={};a.r(r),a.d(r,{GET:()=>u,POST:()=>l});var o=a(49303),i=a(88716),n=a(60670),s=a(87070),c=a(8261);async function u(t){try{let{searchParams:e}=new URL(t.url),a=parseInt(e.get("page")||"1"),r=parseInt(e.get("limit")||"10"),o=e.get("search")||"";e.get("sortBy");let i=e.get("sortOrder")||"asc",n=(a-1)*r,u=o?{OR:[{authority:{contains:o,mode:"insensitive"}},{state:{contains:o,mode:"insensitive"}}]}:{},l=(await c._.outfall.groupBy({by:["authority"],where:{...u,authority:{not:null}}})).length,p=await c._.outfall.groupBy({by:["authority","id","contact","contact_email","contact_name","state","createdAt","updatedAt"],where:{...u,authority:{not:null}},skip:n,take:r,orderBy:{authority:i}});return s.NextResponse.json({data:p.map(t=>({id:t.id,authority:t.authority,contact:t.contact,contact_email:t.contact_email,contact_name:t.contact_name,state:t.state,createdAt:t.createdAt,updatedAt:t.updatedAt})),pagination:{total:l,page:a,limit:r,totalPages:Math.ceil(l/r)}})}catch(t){return console.error("Error fetching water authorities:",t),s.NextResponse.json({error:"Failed to fetch water authorities"},{status:500})}}async function l(t){try{let e=await t.json(),a=await c._.outfall.create({data:{authority:e.authority,contact:e.contact,contact_email:e.contact_email,contact_name:e.contact_name,state:e.state},select:{id:!0,authority:!0,contact:!0,contact_email:!0,contact_name:!0,state:!0,createdAt:!0,updatedAt:!0}});return s.NextResponse.json(a,{status:201})}catch(t){return console.error("Error creating water authority:",t),s.NextResponse.json({error:"Failed to create water authority"},{status:500})}}let p=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/water-authorities/route",pathname:"/api/water-authorities",filename:"route",bundlePath:"app/api/water-authorities/route"},resolvedPagePath:"/home/bish/Downloads/sites/crm-platform/app/api/water-authorities/route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:d,staticGenerationAsyncStorage:h,serverHooks:m}=p,y="/api/water-authorities/route";function g(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}},8261:(t,e,a)=>{a.d(e,{_:()=>o});var r=a(53524);let o=globalThis.prisma??new r.PrismaClient}};var e=require("../../../webpack-runtime.js");e.C(t);var a=t=>e(e.s=t),r=e.X(0,[8948,5972],()=>a(21191));module.exports=r})();