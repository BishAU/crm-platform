"use strict";(()=>{var e={};e.id=2694,e.ids=[2694],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},31447:(e,t,n)=>{n.r(t),n.d(t,{originalPathname:()=>h,patchFetch:()=>x,requestAsyncStorage:()=>p,routeModule:()=>d,serverHooks:()=>l,staticGenerationAsyncStorage:()=>g});var i={};n.r(i),n.d(i,{GET:()=>m,POST:()=>c});var o=n(49303),r=n(88716),s=n(60670),a=n(8261),u=n(87070);async function m(e){try{let{searchParams:t}=new URL(e.url),n=parseInt(t.get("page")||"1"),i=parseInt(t.get("limit")||"10"),o=t.get("search")||"",r=t.get("sortBy")||"name",s=t.get("sortOrder")||"asc",m=(n-1)*i,c=o?{OR:[{name:{contains:o,mode:"insensitive"}},{region:{contains:o,mode:"insensitive"}}]}:{},d=await a._.indigenousCommunity.count({where:c}),p=await a._.indigenousCommunity.findMany({where:c,skip:m,take:i,orderBy:{[r]:s}});return u.NextResponse.json({data:p,pagination:{total:d,page:n,limit:i,totalPages:Math.ceil(d/i)}})}catch(e){return console.error("Error fetching indigenous communities:",e),u.NextResponse.json({error:"Failed to fetch indigenous communities"},{status:500})}}async function c(e){try{let t=await e.json(),n=await a._.indigenousCommunity.create({data:t});return u.NextResponse.json(n,{status:201})}catch(e){return console.error("Error creating indigenous community:",e),u.NextResponse.json({error:"Failed to create indigenous community"},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:r.x.APP_ROUTE,page:"/api/indigenous-communities/route",pathname:"/api/indigenous-communities",filename:"route",bundlePath:"app/api/indigenous-communities/route"},resolvedPagePath:"/home/bish/Downloads/sites/crm-platform/app/api/indigenous-communities/route.ts",nextConfigOutput:"standalone",userland:i}),{requestAsyncStorage:p,staticGenerationAsyncStorage:g,serverHooks:l}=d,h="/api/indigenous-communities/route";function x(){return(0,s.patchFetch)({serverHooks:l,staticGenerationAsyncStorage:g})}},8261:(e,t,n)=>{n.d(t,{_:()=>o});var i=n(53524);let o=globalThis.prisma??new i.PrismaClient}};var t=require("../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),i=t.X(0,[8948,5972],()=>n(31447));module.exports=i})();